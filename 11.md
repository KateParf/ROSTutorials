**Предварительно**

**Установить колкон**

```
pip install -U colcon-common-extensions
```
---

**Создать рабочее пространство**

Сначала создадим каталог ( ros2_ws), в котором будет храниться наше рабочее пространство:

```
md \dev\ros2_ws\src
cd \dev\ros2_ws
```
![image](https://github.com/user-attachments/assets/e97d11f5-64d9-4056-a74d-f64fcc94c001)

---

**Добавить некоторые источники**

Давайте клонируем репозиторий примеров в srcкаталог рабочей области:
```
git clone https://github.com/ros2/examples src/examples -b rolling
```
Теперь в рабочей области должен быть исходный код примеров ROS 2:
![image](https://github.com/user-attachments/assets/1a48127d-18d0-4e08-8fe3-c52f0afb0927)

---

**Источник подложки**

Важно, чтобы мы получили среду для существующей установки ROS 2, которая предоставит нашему рабочему пространству необходимые зависимости сборки для пакетов примеров. Это достигается путем получения сценария установки, предоставленного двоичной установкой или исходной установкой, т. е. другим рабочим пространством colcon (см. Установка ). Мы называем эту среду underlay.

Наше рабочее пространство ros2_ws, будет наложением поверх существующей установки ROS 2. В целом, рекомендуется использовать наложение, когда вы планируете выполнять итерацию небольшого количества пакетов, а не помещать все свои пакеты в одно и то же рабочее пространство.

---

**Создайте рабочее пространство**

В корне рабочего пространства запустите . Поскольку такие типы сборки, как , не поддерживают концепцию пространства и требуют установки пакета, colcon поддерживает опцию . Это позволяет изменять установленные файлы, изменяя файлы в пространстве (например, файлы Python или другие нескомпилированные ресурсы) для более быстрой итерации.colcon buildament_cmakedevel--symlink-installsource

```
colcon build --symlink-install --merge-install
```

Windows не допускает длинных путей, поэтому merge-installобъединит все пути в installкаталог.

После завершения сборки мы должны увидеть каталоги build, installи log:

---

**Проведение тестов**

Чтобы запустить тесты для только что созданных нами пакетов, выполните следующее:
```
colcon test --merge-install
```

**Источник окружающей среды**

После успешного завершения сборки colcon вывод будет находиться в installкаталоге. Перед тем, как вы сможете использовать любой из установленных исполняемых файлов или библиотек, вам нужно будет добавить их в ваш путь и пути библиотек. colcon сгенерирует файлы bash/bat в каталоге, installчтобы помочь настроить среду. Эти файлы добавят все необходимые элементы в ваш путь и пути библиотек, а также предоставят любые команды bash или shell, экспортируемые пакетами.

```
call install\setup.bat
```

**Попробуйте демо-версию**

С исходной средой мы можем запустить исполняемые файлы, созданные colcon. Давайте запустим узел подписчика из примеров:

```
ros2 run examples_rclcpp_minimal_subscriber subscriber_member_function
```

В другом терминале запустим узел издателя (не забудьте указать источник скрипта настройки):

```
ros2 run examples_rclcpp_minimal_publisher publisher_member_function
```

Вы должны увидеть сообщения от издателя и подписчика с увеличивающимися номерами.

**Создайте свой собственный пакет**

colcon использует package.xmlспецификацию, определенную в REP 149 ( формат 2 также поддерживается).

colcon поддерживает несколько типов сборки. Рекомендуемые типы сборки — ament_cmakeи ament_python. Также поддерживаются чистые cmakeпакеты.

Примером сборки ament_pythonявляется пакет ament_index_python , где setup.py является основной точкой входа для сборки.

Такой пакет, как demo_nodes_cpp , использует ament_cmakeтип сборки и использует CMake в качестве инструмента сборки.

Для удобства вы можете использовать инструмент для создания нового пакета на основе шаблона.ros2 pkg create

**Настраивать colcon_cd**

Команда colcon_cdпозволяет быстро изменить текущий рабочий каталог вашей оболочки на каталог пакета. Например, быстро перенесет вас в каталог .colcon_cd some_ros_package~/ros2_ws/src/some_ros_package

```
echo "source /usr/share/colcon_cd/function/colcon_cd.sh" >> ~/.bashrc
echo "export _colcon_cd_root=/opt/ros/rolling/" >> ~/.bashrc
```

В зависимости от способа установки colcon_cdи места расположения вашего рабочего пространства, приведенные выше инструкции могут различаться, для получения более подробной информации обратитесь к документации . Чтобы отменить это в Linux и macOS, найдите скрипт запуска оболочки вашей системы и удалите добавленные команды source и export.

**colcon Завершение вкладки «Настройка»**

Команда colconподдерживает завершение команд для bash и bash-подобных оболочек. colcon-argcompleteПакет должен быть установлен, и для его работы может потребоваться некоторая настройка.

**Советы**

Если вы не хотите собирать определенный пакет, поместите пустой файл с указанным именем COLCON_IGNOREв каталог, и он не будет индексироваться.

Если вы хотите избежать настройки и сборки тестов в пакетах CMake, вы можете передать: .--cmake-args -DBUILD_TESTING=0

Если вы хотите запустить один конкретный тест из пакета:

```
colcon test --packages-select YOUR_PKG_NAME --ctest-args -R YOUR_TEST_IN_PKG
```

**Настройка colcon миксинов**

Различные параметры командной строки утомительно писать и/или трудно запомнить.

Например, чтобы изменить тип сборки CMake на отладочный, обычно используется:

```
colcon build --cmake-args -DCMAKE_BUILD_TYPE=Debug
```

Для упрощения вызова общих параметров командной строки в этом репозитории предусмотрены следующие «ярлыки».

Чтобы установить миксины colcon по умолчанию, выполните следующее:

```
colcon mixin add default https://raw.githubusercontent.com/colcon/colcon-mixin-repository/master/index.yaml
colcon mixin update default
```

Затем попробуйте использовать debug миксин:
```
colcon build --mixin debug
```
