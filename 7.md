# [Понимание действий(actions)](https://docs.ros.org/en/rolling/Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Actions/Understanding-ROS2-Actions.html)

Действия являются одним из типов коммуникации в ROS 2 и предназначены для длительных задач. Они состоят из трех частей: цель, обратная связь и результат.

Действия построены на темах и сервисах. Их функциональность похожа на сервисы, за исключением того, что действия можно отменить. 
Они также обеспечивают постоянную обратную связь, в отличие от сервисов, которые возвращают один ответ.

Действия используют модель клиент-сервер, похожую на модель издатель-подписчик(publisher-subscriber). Узел клиент действия(action client) отправляет цель узлу сервер действия(action server), который подтверждает цель и возвращает поток обратной связи и результат.

### 1. Подготовка

Запускаем Turtlesim. Открываем новый терминал и выполняем: `ros2 run turtlesim turtlesim_node`. Открываем другой новый терминал и выполняем: `ros2 run turtlesim turtle_teleop_key`.

*По умолчанию имена этих узлов — /turtlesim и /teleop_turtle*

### 2. Используйте действия

При запуске узла /teleop_turtle мы видим следующее сообщение в терминале: 
```
Use arrow keys to move the turtle.
Use g|b|v|c|d|e|r|t keys to rotate to absolute orientations. 'f' to cancel a rotation. 'q' to quit.
```
Давайте сосредоточимся на второй строке, которая соответствует действию. Обратим внимание, что буквенные клавиши G|B|V|C|D|E|R|T образуют «рамку» вокруг клавиши F на клавиатуре US QWERTY. 
Положение каждой клавиши вокруг F соответствует этой ориентации в turtlesim. Например, E повернет ориентацию черепахи в верхний левый угол.

Обратим внимание на терминал, где запущен узел /turtlesim. Каждый раз, когда мы нажимаем одну из этих клавиш, мы отправляем цель на сервер действий, который является частью узла /turtlesim. 
Цель состоит в том, чтобы повернуть черепаху в определенном направлении. 
Сообщение, передающее результат цели, должно появиться после того, как черепаха завершит свое вращение: 

`[INFO] [turtlesim]: Rotation goal completed successfully`

Клавиша F отменит цель в середине выполнения.

Попробуем нажать клавишу C, а затем клавишу F до того, как черепаха сможет завершить свое вращение. 
В терминале, где запущен узел /turtlesim, мы видим сообщение: 

`[INFO] [turtlesim]: Rotation goal canceled`

Не только клиентская сторона (наш ввод в teleop) может остановить цель, но и серверная сторона (узел /turtlesim). 
Когда серверная сторона решает остановить обработку цели, она «отменяет» цель.

Попробуем нажать клавишу D, а затем клавишу G до того, как первый поворот сможет завершиться. 
В терминале, где запущен узел /turtlesim, мы видим сообщение: 

`[WARN] [turtlesim]: Rotation goal received before a previous goal finished. Aborting previous goal`

Этот сервер действий решил отменить первую цель, потому что получил новую. Он мог выбрать что-то другое, например, отклонить новую цель или выполнить вторую цель после завершения первой. 
Но не каждый сервер действий выберет отмену текущей цели, когда получит новую.

### 3. ros2 node info

Чтобы увидеть список действий, предоставляемых узлом, в данном случае /turtlesim, откроем новый терминал и выполним команду: `ros2 node info /turtlesim`, которая вернет список подписчиков, издателей, служб, серверов действий и клиентов действий /turtlesim.

![image](https://github.com/user-attachments/assets/c6dbae91-081d-45fa-b7a9-7c5947a1c9d8)

Обратите внимание, что действие /turtle1/rotate_absolute для /turtlesim находится в разделе Action Servers. 
Это означает, что /turtlesim отвечает и обеспечивает обратную связь для действия /turtle1/rotate_absolute.

Узел /teleop_turtle имеет имя /turtle1/rotate_absolute в разделе Action Clients, что означает, что он отправляет цели для этого имени действия. Чтобы увидеть это, выполним: `ros2 node info /teleop_turtle`.

![image](https://github.com/user-attachments/assets/2a4647be-13c8-4cad-ae3f-9a0d4d476457)

### 4. ros2 action list
#### 4.1. ros2 action list -t
### 5. ros2 action type
### 6. ros2 action info
### 7. ros2 interface show
### 8. ros2 action send_goal
