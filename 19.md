**Использование ros 2 doctor для выявления проблем**

**Задачи**

**1 Проверьте ваши настройки**

Давайте рассмотрим вашу общую настройку ROS 2 в целом с помощью ros2doctor. Сначала запустите ROS 2 в новом терминале, затем введите команду:

~~~
ros2 doctor
~~~

Это позволит выполнить проверку всех ваших модулей настройки и вывести предупреждения и ошибки.

Если ваша настройка ROS 2 в идеальном состоянии, вы увидите сообщение, похожее на это:

~~~
All <n> checks passed
~~~

Однако не редкость получить несколько предупреждений. Это UserWarningне означает, что ваша настройка непригодна для использования; скорее всего, это просто указание на то, что что-то настроено неидеальным образом.

Если вы получили предупреждение, оно будет выглядеть примерно так:

~~~
<path>: <line>: UserWarning: <message>
~~~

Например, ros2doctorвы увидите это предупреждение, если используете нестабильный дистрибутив ROS 2:

~~~
UserWarning: Distribution <distro> is not fully supported or tested. To get more consistent features, download a stable version at https://index.ros.org/doc/ros2/Installation/
~~~

Если ros2doctorв вашей системе обнаружены только предупреждения, вы все равно получите сообщение.All <n> checks passed

Большинство проверок классифицируются как предупреждения, а не как ошибки. В основном вам, пользователю, решать, насколько важны возвращаемые отзывы ros2doctor. Если в вашей настройке обнаруживается редкая ошибка, обозначенная , проверка считается не пройденной.UserWarning: ERROR:

Вы увидите сообщение, похожее на следующий список отзывов о проблемах:

~~~
1/3 checks failed

Failed modules:  network
~~~
Ошибка указывает на то, что в системе отсутствуют важные настройки или функции, имеющие решающее значение для ROS 2. Ошибки следует устранить, чтобы обеспечить правильное функционирование системы.

---

**2 Проверить систему**

Вы также можете изучить работающую систему ROS 2, чтобы определить возможные причины проблем. Чтобы увидеть ros2doctorработу работающей системы, давайте запустим turtlesim, в котором узлы активно взаимодействуют друг с другом.

Запустите систему, открыв новый терминал, выбрав ROS 2 и введя команду:

~~~
ros2 run turtlesim turtlesim_node
~~~

Откройте другой терминал и запустите ROS 2 для запуска телеуправления:

~~~
ros2 run turtlesim turtle_teleop_key
~~~

Теперь запустите ros2doctor снова в его собственном терминале. Вы увидите предупреждения и ошибки, которые у вас были в последний раз, когда вы запускали ros2doctorвашу установку, если они у вас были. После этого будет несколько новых предупреждений, касающихся самой системы:

~~~
UserWarning: Publisher without subscriber detected on /turtle1/color_sensor.
UserWarning: Publisher without subscriber detected on /turtle1/pose.
~~~

Похоже, что /turtlesimузел публикует данные в двух темах, на которые не подписан пользователь, и ros2doctorсчитает, что это может привести к проблемам.

Если вы выполните команды для вывода тем /color_sensorи /pose, эти предупреждения исчезнут, поскольку у издателей появятся подписчики.

Вы можете попробовать это, открыв два новых терминала, пока Turtlesim все еще запущен, загрузив ROS 2 в каждый и выполнив каждую из следующих команд в их собственных терминалах:

~~~
ros2 topic echo /turtle1/color_sensor
~~~
~~~
ros2 topic echo /turtle1/pose
~~~

Затем снова запустите ros2doctorего в терминале. Предупреждения исчезнут. (Обязательно введите в терминалах, где вы запустили ).publisher without subscriberCtrl+Cecho

Теперь попробуйте выйти из окна turtlesim или выйти из teleop и запустить ros2doctorснова. Вы увидите больше предупреждений, указывающих или для разных тем, теперь, когда один узел в системе недоступен.publisher without subscribersubscriber without publisher

В сложной системе со множеством узлов ros2doctorэто было бы бесценно для выявления возможных причин проблем со связью.

---

**3 Получить полный отчет**

Хотя ros2doctorон и выдаст вам предупреждения о вашей сети, системе и т. д., запуск его с --reportаргументом предоставит вам гораздо больше подробностей, которые помогут вам проанализировать проблемы.

Вы можете использовать его, --reportесли получили предупреждение о настройке сети и хотите точно узнать, какая часть конфигурации вызывает предупреждение.

Это также очень полезно, когда вам нужно открыть тикет поддержки, чтобы получить помощь по ROS 2. Вы можете скопировать и вставить соответствующие части вашего отчета в тикет, чтобы люди, которые вам помогают, могли лучше понять вашу среду и оказать более качественную помощь.

Чтобы получить полный отчет, введите в терминале следующую команду:

~~~
ros2 doctor --report
~~~

Что вернет список информации, разделенной на пять групп:

~~~
NETWORK CONFIGURATION
...

PLATFORM INFORMATION
...

RMW MIDDLEWARE
...

ROS 2 INFORMATION
...

TOPIC LIST
...
~~~
Вы можете перепроверить информацию здесь с предупреждениями, которые вы получаете при запуске . Например, если возвращено предупреждение (упомянутое ранее) о том, что ваш дистрибутив «не полностью поддерживается или протестирован», вы можете взглянуть на раздел отчета:ros2 doctorros2doctorROS 2 INFORMATION

~~~
distribution name      : <distro>
distribution type      : ros2
distribution status    : prerelease
release platforms      : {'<platform>': ['<version>']}
~~~

Здесь вы можете увидеть is , что объясняет, почему он не поддерживается полностью.distribution statusprerelease

---

**Краткое содержание**

ros2doctorпроинформирует вас о проблемах в вашей настройке ROS 2 и работающих системах. Вы можете получить более глубокий взгляд на информацию, стоящую за этими предупреждениями, используя --reportаргумент.

Помните, ros2doctorчто это не инструмент отладки; он не поможет устранить ошибки в вашем коде или на стороне реализации вашей системы.
